<!DOCTYPE html>
<html lang="en">
    <head prefix="og: http://ogp.me/ns#">
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="application-name" content="Mousehole" />
  <meta name="apple-mobile-web-app-status-bar-style" content="#fff" />
  <meta name="apple-mobile-web-app-title" content="Mousehole" />
  <title>
  Notes - Package manager - Mousehole
  </title>
  <link rel="alternate" href="https://Dirout.github.io/blog/posts/2021/05/09/notes-package-manager/" hreflang="en" />
  <link rel="canonical" href="https://Dirout.github.io/blog/posts/2021/05/09/notes-package-manager/" />
  <meta name="description"  content="Musings from the mice"  />
  <meta name="referrer" content="no-referrer-when-downgrade" />
  <meta property="og:site_name" content="Notes - Package manager | Em Sayahi " />
  <meta property="og:title" content="Notes - Package manager | Em Sayahi" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://Dirout.github.io/blog/posts/2021/05/09/notes-package-manager/" />
  <meta property="og:description"  content="Musings from the mice"  />
  
  <meta property="og:image" content="https://Dirout.github.io/blog/assets/img/ogp.png" />
  
  <meta property="og:image:width" content="640" />
  <meta property="og:image:height" content="640" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Notes - Package manager | Em Sayahi" />
  <meta name="twitter:url" content="https://Dirout.github.io/blog/posts/2021/05/09/notes-package-manager/" />
  <meta name="twitter:site" content="Mousehole" />
  <meta name="twitter:creator" content="Em Sayahi" />
  <meta name="twitter:description" content="Musings from the mice"  />
  
  <meta name="twitter:image" content="https://Dirout.github.io/blog/assets/img/ogp.png" />
  
  <link rel="apple-touch-icon" sizes="180x180" href="https://Dirout.github.io/blog/assets/favicons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="https://Dirout.github.io/blog/assets/favicons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="https://Dirout.github.io/blog/assets/favicons/favicon-16x16.png" />
  <link rel="mask-icon" href="https://Dirout.github.io/blog/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" />
  <meta name="apple-mobile-web-app-title" content="Mousehole" />
  <meta name="application-name" content="Mousehole" />
  <meta name="msapplication-TileColor" content="#da532c" />
  <meta name="theme-color" content="#2c2c2c" />
  <link rel="stylesheet" href="https://Dirout.github.io/blog/assets/css/style.css" />
</head>


    <body data-theme="dark" class="notransition">
        <script>
            const body = document.body;
            const data = body.getAttribute("data-theme");

            const initTheme = (state) => {
                if (state === "dark") {
                    body.setAttribute("data-theme", "dark");
                } else if (state === "light") {
                    body.removeAttribute("data-theme");
                } else {
                    localStorage.setItem("theme", data);
                }
            };

            initTheme(localStorage.getItem("theme"));

            setTimeout(() => body.classList.remove("notransition"), 75);
        </script>

        <div class="navbar" role="navigation">
  <nav class="menu">
    <input type="checkbox" id="menu-trigger" class="menu-trigger" />
    <label for="menu-trigger">
      <span class="menu-icon">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 512 512"
        >
          <path
            d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z"
          />
        </svg>
      </span>
    </label>
    <a id="mode">
      <svg
        class="mode-sunny"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 512 512"
      >
        <title>Day</title>
        <line
          x1="256"
          y1="48"
          x2="256"
          y2="96"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="256"
          y1="416"
          x2="256"
          y2="464"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="108.92"
          x2="369.14"
          y2="142.86"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="369.14"
          x2="108.92"
          y2="403.08"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="464"
          y1="256"
          x2="416"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="96"
          y1="256"
          x2="48"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="403.08"
          x2="369.14"
          y2="369.14"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="142.86"
          x2="108.92"
          y2="108.92"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <circle
          cx="256"
          cy="256"
          r="80"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
      </svg>
      <svg
        class="mode-moon"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 512 512"
      >
        <title>Night</title>
        <line
          x1="256"
          y1="48"
          x2="256"
          y2="96"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="256"
          y1="416"
          x2="256"
          y2="464"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="108.92"
          x2="369.14"
          y2="142.86"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="369.14"
          x2="108.92"
          y2="403.08"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="464"
          y1="256"
          x2="416"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="96"
          y1="256"
          x2="48"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="403.08"
          x2="369.14"
          y2="369.14"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="142.86"
          x2="108.92"
          y2="108.92"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <circle
          cx="256"
          cy="256"
          r="80"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
      </svg>
    </a>
    <div class="trigger">
      <div class="trigger-container"><a class="menu-link" href="https://Dirout.github.io/blog/">home</a><a class="menu-link" href="https://Dirout.github.io/blog/archive.html">archive</a><a class="menu-link" href="https://Dirout.github.io/blog/about.html">about</a><a class="menu-link rss" href="https://Dirout.github.io/blog/feed.xml">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="17"
            height="17"
            viewBox="0 0 512 512"
            fill="#ED812E"
          >
            <title>RSS</title>
            <path
              d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"
            />
            <path
              d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"
            />
            <path
              d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"
            />
          </svg>
        </a>
      </div>
    </div>
  </nav>
</div>

        <div class="wrapper post">
            <main class="page-content" aria-label="Content">
                <article itemscope itemtype="https://schema.org/BlogPosting">
                    <header class="header">
                        
                        <div class="tags">
                            
                            <span itemprop="keywords">
                                
                                <a class="tag" href="https://Dirout.github.io/blog/tags.html#micro">MICRO</a> 
                            </span>
                        </div>
                        
                        <h1 class="header-title" itemprop="headline">Notes - Package manager</h1>
                        
                        <div class="post-meta">
                            <time datetime="2021-05-09T17:50:04+00:00" itemprop="datePublished">
                                9 May 2021
                            </time>
                            <span itemprop="author" itemscope itemtype="https://schema.org/Person">
                                <span itemprop="name">Em Sayahi</span>
                            </span>
                            
                            <span hidden itemprop="publisher" itemtype="Person">Em Sayahi</span>
                            
                            <span hidden itemprop="mainEntityOfPage"><p>Package manager:</p>
<ul>
<li>Install</li>
<li>Remove</li>
<li>Upgrade</li>
</ul>
<h1>Install</h1>
<ol>
<li>Attempt to get list of dependencies
<ol>
<li>Outcome one: No dependencies (<strong>continue</strong>)</li>
<li>Outcome two: Impossible situation (<strong>error</strong>)</li>
<li>Outcome three: Dependency list satisfied (<strong>continue</strong>)
<ul>
<li>It appears using a SAT solver would be best. Only one problem … I can’t understand how to use it or what exactly one does.
<ul>
<li>Things I’ve looked at:
<ol>
<li><a href="https://research.swtch.com/version-sat">Version SAT by Russ Cox</a></li>
<li><a href="https://github.com/rust-lang/cargo/blob/8b5aec111926d1d03d2da32dd494e0fff073f870/src/cargo/core/resolver/mod.rs#L426">Cargo’s dependency resolution</a></li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
<li>Decide order of dependency installation
<ul>
<li>Some can be installed in parallel</li>
<li>It appears the best algorithm for this would be a topological sort? Not sure what that is yet</li>
</ul>
</li>
<li>Done!</li>
</ol>
<h3>Things to consider</h3>
<ul>
<li>Hooks? Here’s <a href="https://michael.stapelberg.ch/posts/2019-07-20-hooks-and-triggers/">an article</a> on the subject.
<ul>
<li>Packages with hooks can’t be installed in parallel with other packages.</li>
<li>Hooks present many downsides, but having package manager triggers don’t seem any better. The alternative would be to have the package manager hardcode a pre-set list of actions, but I don’t see how this would improve the primary downside: an interruption to installation.</li>
</ul>
</li>
<li>Installing an individual package?
<ul>
<li>The mainstream approach is archive extraction. This would be a bit slow, wouldn’t it? Would it be possible to download files directly to the machine? Wouldn’t this increase download times despite lowering processor time? Perhaps a disk image would work instead? But how would you use it after mounting it, and wouldn’t this lead to the same problem of increasing download times if the disk image is bigger than an archive?</li>
</ul>
</li>
<li>Keeping track of installed packages?
<ul>
<li>Binary serialization using <a href="https://crates.io/crates/bincode"><code>bincode</code></a> of a <code>Vec&lt;&amp;str&gt;</code> containing installed package names
<ul>
<li>Would loading all the installed packages into RAM from disk really be such a good idea? Ultimately, my primary concern is performance. How much space would a list of, say, 4,000 packages take up on disk? What about in RAM?</li>
<li>Consider databases instead? Find the fastest Rust database implementation that’ll work.</li>
</ul>
</li>
</ul>
</li>
</ul>
</span>
                        </div>
                        
                    </header>

                    <div class="page-content" itemprop="articleBody">
                        <p>Package manager:</p>
<ul>
<li>Install</li>
<li>Remove</li>
<li>Upgrade</li>
</ul>
<h1>Install</h1>
<ol>
<li>Attempt to get list of dependencies
<ol>
<li>Outcome one: No dependencies (<strong>continue</strong>)</li>
<li>Outcome two: Impossible situation (<strong>error</strong>)</li>
<li>Outcome three: Dependency list satisfied (<strong>continue</strong>)
<ul>
<li>It appears using a SAT solver would be best. Only one problem … I can’t understand how to use it or what exactly one does.
<ul>
<li>Things I’ve looked at:
<ol>
<li><a href="https://research.swtch.com/version-sat">Version SAT by Russ Cox</a></li>
<li><a href="https://github.com/rust-lang/cargo/blob/8b5aec111926d1d03d2da32dd494e0fff073f870/src/cargo/core/resolver/mod.rs#L426">Cargo’s dependency resolution</a></li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
<li>Decide order of dependency installation
<ul>
<li>Some can be installed in parallel</li>
<li>It appears the best algorithm for this would be a topological sort? Not sure what that is yet</li>
</ul>
</li>
<li>Done!</li>
</ol>
<h3>Things to consider</h3>
<ul>
<li>Hooks? Here’s <a href="https://michael.stapelberg.ch/posts/2019-07-20-hooks-and-triggers/">an article</a> on the subject.
<ul>
<li>Packages with hooks can’t be installed in parallel with other packages.</li>
<li>Hooks present many downsides, but having package manager triggers don’t seem any better. The alternative would be to have the package manager hardcode a pre-set list of actions, but I don’t see how this would improve the primary downside: an interruption to installation.</li>
</ul>
</li>
<li>Installing an individual package?
<ul>
<li>The mainstream approach is archive extraction. This would be a bit slow, wouldn’t it? Would it be possible to download files directly to the machine? Wouldn’t this increase download times despite lowering processor time? Perhaps a disk image would work instead? But how would you use it after mounting it, and wouldn’t this lead to the same problem of increasing download times if the disk image is bigger than an archive?</li>
</ul>
</li>
<li>Keeping track of installed packages?
<ul>
<li>Binary serialization using <a href="https://crates.io/crates/bincode"><code>bincode</code></a> of a <code>Vec&lt;&amp;str&gt;</code> containing installed package names
<ul>
<li>Would loading all the installed packages into RAM from disk really be such a good idea? Ultimately, my primary concern is performance. How much space would a list of, say, 4,000 packages take up on disk? What about in RAM?</li>
<li>Consider databases instead? Find the fastest Rust database implementation that’ll work.</li>
</ul>
</li>
</ul>
</li>
</ul>

                    </div>
                </article>
            </main>

             <footer class="footer">
    <a class="footer_item" href="https://Dirout.github.io/blog/feed.xml">rss</a>
    <span class="footer_item">&copy; 2021 Emil Sayahi & Evan Gabriel Burke</span>
    <small class="footer_copyright">
        <a href="https://github.com/dirout/blog" target="_blank" rel="noreferrer noopener">Mousehole</a>
    </small>
</footer>
<script src="https://Dirout.github.io/blog/assets/js/main.js" defer="defer"></script>
        </div>
    </body>
</html>
